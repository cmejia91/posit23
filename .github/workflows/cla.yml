name: "CLA Signature Assistant"
on:
  issue_comment:
    types: [created]
  pull_request_target:
    types: [opened, closed, synchronize]

# explicitly configure permissions, in case your GITHUB_TOKEN workflow permissions are set to read-only in repository settings
permissions:
  actions: write
  contents: read
  pull-requests: write
  statuses: write

jobs:
  RequireCLA:
    steps:
      # Generate an access token; used to access the repository hosting the set
      # of known CLA signatures
      - name: Create access token
        uses: actions/create-github-app-token@v1
        id: app-token
        with:
          app-id: ${{ vars.POSITRON_BOT_APP_ID }}
          private-key: ${{ secrets.POSITRON_BOT_PRIVATE_KEY }}
          owner: ${{ github.repository_owner }}

      # Validate that the CLA has been signed by the author(s)
      - name: Validate CLA signatures
        uses: posit-dev/cla-assistant/.github/workflows/posit-cla.yml@v1
        secrets:
          CLA_ASSISTANT_PAT: ${{ steps.app-token.outputs.token }}
