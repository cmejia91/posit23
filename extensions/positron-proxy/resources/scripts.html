<!DOCTYPE html>
<html>
<!-- This file provides a sane place to develop scripts for use in the PositronProxy extension. -->

<head>
	<!-- The help header script. -->
	<script id="help-header-script">
		(() => {
			// The source.
			const SOURCE = "194c268a-8fb5-4462-8e65-c5ff82ca0a4f";

			// When the document is completely loaded, initialize things.
			document.addEventListener("readystatechange", event => {
				if (document.readyState === "complete") {
					setTitle();
					hijackLinks();
				}
			});

			// Sets the title.
			const setTitle = () => {
				window.parent.postMessage({
					id: `${SOURCE}-set-title`,
					url: window.location.href,
					title: document.title
				}, "*");
			};

			// Hijacks all the links in the document. When a link is clicked, post a message to
			// navigate.
			const hijackLinks = () => {
				var links = document.links;
				for (let i = 0; i < links.length; i++) {
					links[i].onclick = (e) => {
						window.parent.postMessage({
							id: `${SOURCE}-navigate`,
							fromUrl: window.location.href,
							toUrl: links[i].href
						}, "*");
						return false;
					};
				}
			};
		})();
	</script>
</head>

<body>
</body>

</html>
