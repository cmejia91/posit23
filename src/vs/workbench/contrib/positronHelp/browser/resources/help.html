<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="Content-Security-Policy"
		content="default-src 'none'; media-src https:; script-src 'self' 'nonce-__nonce__'; style-src 'nonce-__nonce__'; frame-src *;">
	<style nonce="__nonce__">
		body {
			padding: 0;
		}

		#help-iframe {
			border: none;
			width: 100%;
			height: 100%;
			position: absolute;
		}
	</style>
</head>

<body>
	<iframe id="help-iframe" title="Help Content" src="__sourceURL__" loading="eager">
	</iframe>
	<script nonce="__nonce__" async type="module">
		const vscode = acquireVsCodeApi();
		const childWindow = document.getElementById("help-iframe").contentWindow;
		window.addEventListener("message", message => {
			// If the message is coming from the help iframe content window,
			if (message.source === childWindow) {
				// Filter out anything weird.
				if (!message.data.id.startsWith("positron-help-")) {
					return;
				}

				// When the help iframe content window is interactive, scroll it, if there is a
				// scroll position to restore.
				if (message.data.id === "positron-help-interactive") {
					const scrollX = __scrollX__;
					const scrollY = __scrollY__;
					if (scrollX || scrollY) {
						childWindow.postMessage({
							id: "positron-help-scroll-to",
							scrollX,
							scrollY
						}, "*");
					}
				}

				// Post the message.
				vscode.postMessage(message.data);
			} else {
				switch (message.data.id) {
					case "positron-help-update-find":
						childWindow.postMessage(message.data, "*");
						break;

					case "positron-help-find-previous":
						childWindow.postMessage(message.data, "*");
						break;

					case "positron-help-find-next":
						childWindow.postMessage(message.data, "*");
						break;

					case "positron-help-focus":
						childWindow.postMessage(message.data, "*");
						break;
				}
			}
		});
	</script>
</body>

</html>
